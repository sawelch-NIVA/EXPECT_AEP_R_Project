{
  "hash": "ce3306ccb642f24d5ae1f611c2875e3b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Notebook 02 - Quality Control\"\nauthor: \"Sam Welch\"\ndate: \"2025.11.25\"\nlightbox: true\nformat:\n  html:\n    grid:\n      body-width: 1500px\n      sidebar-width: 0px\n    page-layout: full\n    code-fold: true\n    max-width: 4500px\n    fig-format: png\n    toc: true\n---\n\n<!-- include-in-header:\n  - text\n      <style>\n      /* \"Hide\" TOC sidebar when card is in full-screen mode */\n      .bslib-card[data-full-screen=\"true\"] ~ #quarto-margin-sidebar,\n      body:has(.bslib-card[data-full-screen=\"true\"]) #quarto-margin-sidebar {\n        z-index: 0 !important;\n      }\n      </style> -->\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: targets-setup\n#| warning: false\n#| output: false\n#| echo: false\nlibrary(STOPeData)\nlibrary(DT)\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: targets-setup\n#| warning: false\n#| output: false\n#| echo: false\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(forcats)\nlibrary(viridis)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading required package: viridisLite\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: targets-setup\n#| warning: false\n#| output: false\n#| echo: false\nlibrary(stringr)\nlibrary(ggridges)\nlibrary(ggh4x)\nlibrary(tidygraph)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'tidygraph'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following object is masked from 'package:stats':\n\n    filter\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: targets-setup\n#| warning: false\n#| output: false\n#| echo: false\nlibrary(ggraph)\nlibrary(ggiraph)\nlibrary(leaflet)\nlibrary(sf)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLinking to GEOS 3.13.1, GDAL 3.11.0, PROJ 9.6.0; sf_use_s2() is TRUE\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: targets-setup\n#| warning: false\n#| output: false\n#| echo: false\nlibrary(shiny)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'shiny'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following objects are masked from 'package:DT':\n\n    dataTableOutput, renderDataTable\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: targets-setup\n#| warning: false\n#| output: false\n#| echo: false\nlibrary(dplyr)\nlibrary(bslib)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'bslib'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following object is masked from 'package:utils':\n\n    page\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: targets-setup\n#| warning: false\n#| output: false\n#| echo: false\nlibrary(ggtext)\nlibrary(data.table)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'data.table'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following objects are masked from 'package:dplyr':\n\n    between, first, last\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: targets-setup\n#| warning: false\n#| output: false\n#| echo: false\nlibrary(eDataDRF)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'eDataDRF'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following objects are masked from 'package:STOPeData':\n\n    abbreviate_string, altitude_units_vocabulary,\n    analytical_protocols_vocabulary, areas_vocabulary,\n    coordinate_systems_vocabulary, countries_vocabulary,\n    dummy_parameters_vocabulary, environ_compartments_sub_vocabulary,\n    environ_compartments_vocabulary, extraction_protocols_vocabulary,\n    fractionation_protocols_vocabulary, gender_vocabulary,\n    generate_protocol_id, geographic_features_sub_vocabulary,\n    geographic_features_vocabulary, get_dataset_display_name,\n    initialise_biota_tibble, initialise_campaign_tibble,\n    initialise_compartments_tibble, initialise_CREED_data_tibble,\n    initialise_CREED_scores_tibble, initialise_measurements_tibble,\n    initialise_methods_tibble, initialise_parameters_tibble,\n    initialise_references_tibble, initialise_samples_tibble,\n    initialise_sites_tibble, lifestage_vocabulary,\n    measured_categories_vocabulary, measured_flags_vocabulary,\n    measured_types_vocabulary, parameter_types_sub_vocabulary,\n    parameter_types_vocabulary, parameter_unit_vocabulary,\n    protocol_categories_vocabulary, protocol_options_vocabulary,\n    reference_character_limits, sampling_protocols_vocabulary,\n    species_groups_vocabulary, species_names_vocabulary,\n    tissue_types_vocabulary, uncertainty_types_vocabulary\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: targets-setup\n#| warning: false\n#| output: false\n#| echo: false\nlibrary(here)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nhere() starts at C:/Users/SAW/Local Documents/EXPECT AEP/EXPECT_AEP_R_Project\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: targets-setup\n#| warning: false\n#| output: false\n#| echo: false\nlibrary(targets)\n\nhere::i_am(\"./README.md\") # relative to docs folder\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nhere() starts at C:/Users/SAW/Local Documents/EXPECT AEP/EXPECT_AEP_R_Project\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: targets-setup\n#| warning: false\n#| output: false\n#| echo: false\ntar_config_set(store = here(\"_targets\"))\ndevtools::load_all(path = here::here())\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nℹ Loading EXPECT_AEP_R_Project\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: targets-setup\n#| warning: false\n#| output: false\n#| echo: false\n# cat(\"here() resolves to:\", here::here(), \"\\n\", file = stderr())\n# cat(\"Working directory:\", getwd(), \"\\n\", file = stderr())\n\n# here::i_am(\"./README.md\") # relative to manuscript folder\n# source(here::here(\"_targets.R\"))\n# devtools::load_all(path = here::here())\n\n# cat(\"here() resolves to:\", here::here(), \"\\n\", file = stderr())\n# cat(\"Working directory:\", getwd(), \"\\n\", file = stderr())\n# tar_make(script = targets::tar_config_get(\"script\"))\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: load-data\n# load in any data we need from the targets workflow\nliterature_merged_data <- tar_read(load_literature_pqt)\nliterature_reference_data <- tar_read(reference_data)\nliterature_campaign_data <- tar_read(campaign_data)\nliterature_sites_data <- tar_read(sites_data)\nliterature_qc <- tar_read(data_quality_report)\nwgs84_geo <- tar_read(wgs84_geography)\n\nspecies_names <- eDataDRF::species_names_vocabulary()\nspecies_lookup <- species_names |>\n  with(setNames(SPECIES_COMMON_NAME, SPECIES_NAME))\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: themes-and-helpers\n\ncopper_toxicity_thresholds <- tar_read(copper_toxicity_thresholds)\n# Define threshold colors based on the report ----\nthreshold_colours <- c(\n  \"Background (I)\" = \"#0070C0\", # Blue\n  \"Good (II)\" = \"#00B050\", # Green\n  \"Moderate (III)\" = \"#FFC000\", # Yellow\n  \"Poor (IV)\" = \"#FF6600\", # Orange\n  \"Very Poor (V)\" = \"#FF0000\" # Red\n)\n\ncompartment_colours <- c(\n  # Aquatic ----\n  \"Freshwater\" = \"#4A90E2\", # clear blue\n  \"Marine/Salt Water\" = \"#1E5A8E\", # deep ocean blue\n  \"Brackish/Transitional Water\" = \"#6BA5C8\", # mid-blue (between fresh/marine)\n  \"Groundwater\" = \"#2C5F7B\", # darker, subdued blue\n  \"Wastewater\" = \"#8B7355\", # murky brown\n  \"Liquid Growth Medium\" = \"#9FD8CB\", # pale greenish-blue\n  \"Rainwater\" = \"#B3D9FF\", # light sky blue\n  \"Stormwater\" = \"#607D8B\", # grey-blue\n  \"Leachate\" = \"#6B5344\", # dark muddy brown\n  \"Aquatic Sediment\" = \"#EBCF1B\", # your existing yellow\n  \"Porewater\" = \"#7FA0B8\", # muted blue-grey\n  \"Sludge\" = \"#67AB33\", # your existing green\n\n  # Atmospheric ----\n  \"Indoor Air\" = \"#E8F4F8\", # very pale blue-grey\n  \"Outdoor Air\" = \"#87CEEB\", # sky blue\n\n  # Terrestrial ----\n  \"Terrestrial Biological Residue\" = \"#8B6F47\", # organic brown\n  \"Soil H Horizon (Peat)\" = \"#3E2723\", # very dark brown\n  \"Soil O Horizon (Organic)\" = \"#5D4037\", # dark organic brown\n  \"Soil A Horizon (Topsoil)\" = \"#795548\", # medium brown\n  \"Soil E Horizon (Mineral)\" = \"#A1887F\", # light greyish-brown\n  \"Soil S Horizon (Mineral)\" = \"#BCAAA4\", # pale brown-grey\n  \"Soil C Horizon (Parent Material)\" = \"#D7CCC8\", # very pale brown\n  \"Soil R Horizon (Bedrock)\" = \"#9E9E9E\", # grey\n\n  # Biota ----\n  \"Biota, Terrestrial\" = \"#558B2F\", # forest green\n  \"Biota, Aquatic\" = \"#00695C\", # teal\n  \"Biota, Atmospheric\" = \"#B39DDB\", # light purple (birds/insects)\n  \"Biota, Other\" = \"#9C27B0\" # distinct purple\n)\n\n# Helper function for sample sizes\ncalculate_sample_sizes <- function(data) {\n  data |>\n    group_by(\n      REFERENCE_ID,\n      OCEAN_COUNTRY,\n      SITE_GEOGRAPHIC_FEATURE,\n      ENVIRON_COMPARTMENT_SUB\n    ) |>\n    summarise(total_n = sum(MEASURED_N, na.rm = TRUE), .groups = \"drop\")\n}\n\n# Create sub-compartment letter codes ----\nsubcomp_codes <- c(\n  # Aquatic\n  \"Freshwater\" = \"F\",\n  \"Marine/Salt Water\" = \"M\",\n  \"Brackish/Transitional Water\" = \"B\",\n  \"Groundwater\" = \"G\",\n  \"Wastewater\" = \"WW\",\n  \"Liquid Growth Medium\" = \"LGM\",\n  \"Rainwater\" = \"R\",\n  \"Stormwater\" = \"SW\",\n  \"Leachate\" = \"L\",\n  \"Aquatic Sediment\" = \"AS\",\n  \"Porewater\" = \"P\",\n  \"Sludge\" = \"Sl\",\n  # Atmospheric\n  \"Indoor Air\" = \"IA\",\n  \"Outdoor Air\" = \"OA\",\n  # Terrestrial\n  \"Terrestrial Biological Residue\" = \"TBR\",\n  \"Soil H Horizon (Peat)\" = \"H\",\n  \"Soil O Horizon (Organic)\" = \"O\",\n  \"Soil A Horizon (Topsoil)\" = \"A\",\n  \"Soil E Horizon (Mineral)\" = \"E\",\n  \"Soil S Horizon (Mineral)\" = \"S\",\n  \"Soil C Horizon (Parent Material)\" = \"C\",\n  \"Soil R Horizon (Bedrock)\" = \"R\",\n  # Biota\n  \"Biota, Terrestrial\" = \"BT\",\n  \"Biota, Aquatic\" = \"BA\",\n  \"Biota, Atmospheric\" = \"BAm\",\n  \"Biota, Other\" = \"BO\"\n)\n```\n:::\n\n\n\n## Data Quality Overview {#sec-data-quality}\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: quality-summary\n#| echo: false\n#| output: asis\n\n#' Generate a text summary of data quality issues\n#'\n#' @param qc_report Output from check_data_quality()\n#' @return A character string with markdown-formatted summary\nformat_quality_summary <- function(qc_report) {\n  s <- qc_report$summary\n\n  glue::glue(\n    \"\nDataset contains **{s$total_rows}** rows from **{s$total_references}** references across **{s$total_sites}** sites.\n\n**Issues identified:**\n\n- **Measurements**: {s$n_rows_missing_measurements} rows ({s$n_refs_missing_measurements} references) missing all measurement data (value, LOQ, and LOD)\n- **Sample size**: {s$n_rows_missing_n} rows ({s$n_refs_missing_n} references) missing or zero sample size\n- **Methods**: {s$n_rows_missing_methods} rows ({s$n_refs_missing_methods} references) missing method information\n- **Uncertainty**: {s$n_rows_missing_uncertainty} rows ({s$n_refs_missing_uncertainty} references) missing uncertainty type\n- **Site data**: {s$n_sites_missing_data} sites ({s$n_refs_missing_sites} references) missing location/geographic data\n- **Biota data**: {s$n_rows_missing_biota} rows ({s$n_refs_missing_biota} references) missing species/tissue information\n\"\n  )\n}\n\ncat(format_quality_summary(literature_qc))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nDataset contains **48972** rows from **32** references across **5142** sites.\n\n**Issues identified:**\n\n- **Measurements**: 52 rows (2 references) missing all measurement data (value, LOQ, and LOD)\n- **Sample size**: 49 rows (1 references) missing or zero sample size\n- **Methods**: 49 rows (1 references) missing method information\n- **Uncertainty**: 48842 rows (18 references) missing uncertainty type\n- **Site data**: 4 sites (2 references) missing location/geographic data\n- **Biota data**: 1 rows (1 references) missing species/tissue information\n```\n\n\n:::\n:::\n\n\n::: {.callout-note collapse=\"true\"}\n## Missing Data\n\n### Missing Measurements\n\nRows where measured value, LOQ, and LOD are all missing.\n\nKnown issues:\n\n-   2025PelkonenEnvironmentalImpactOf does not report LOD/LOQ values in main paper or ESI.\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: missing-measurements\n#| echo: false\n\nif (nrow(literature_qc$missing_measurements) > 0) {\n  DT::datatable(\n    literature_qc$missing_measurements |>\n      dplyr::select(-sample_ids),\n    options = list(pageLength = 10),\n    caption = \"References with missing measurement data\"\n  )\n} else {\n  cat(\"*No missing measurements found.*\")\n}\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-185bb55068dcaf4e57fc\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-185bb55068dcaf4e57fc\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"caption\":\"<caption>References with missing measurement data<\\/caption>\",\"data\":[[\"1\",\"2\"],[\"\",\"2025PelkonenEnvironmentalImpactOf\"],[49,3]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>REFERENCE_ID<\\/th>\\n      <th>n_rows<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":10,\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":2},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"REFERENCE_ID\",\"targets\":1},{\"name\":\"n_rows\",\"targets\":2}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Missing Sample Size\n\nRows where MEASURED_N is missing or zero.\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: missing-n\n#| echo: false\n\nif (nrow(literature_qc$missing_n) > 0) {\n  DT::datatable(\n    literature_qc$missing_n |>\n      dplyr::select(-sample_ids),\n    options = list(pageLength = 10),\n    caption = \"References with missing sample size\"\n  )\n} else {\n  cat(\"*No missing sample sizes found.*\")\n}\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-f96228cb8e0d7ad006b8\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-f96228cb8e0d7ad006b8\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"caption\":\"<caption>References with missing sample size<\\/caption>\",\"data\":[[\"1\"],[\"\"],[49]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>REFERENCE_ID<\\/th>\\n      <th>n_rows<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":10,\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":2},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"REFERENCE_ID\",\"targets\":1},{\"name\":\"n_rows\",\"targets\":2}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Missing Methods\n\nRows missing any of: analytical protocol, extraction protocol, fractionation protocol, or sampling protocol.\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: missing-methods\n#| echo: false\n\n#| label: missing-methods\n#| echo: false\n\nif (nrow(literature_qc$missing_methods) > 0) {\n  display_df <- literature_qc$missing_methods |>\n    dplyr::mutate(\n      analytical_issue = dplyr::case_when(\n        missing_analytical ~ \"Missing\",\n        .default = NA_character_\n      ),\n      extraction_issue = dplyr::case_when(\n        missing_extraction ~ \"Missing\",\n        .default = NA_character_\n      ),\n      fractionation_issue = dplyr::case_when(\n        missing_fractionation ~ \"Missing\",\n        .default = NA_character_\n      ),\n      sampling_issue = dplyr::case_when(\n        missing_sampling ~ \"Missing\",\n        .default = NA_character_\n      )\n    ) |>\n    dplyr::select(\n      REFERENCE_ID,\n      n_rows,\n      analytical_issue,\n      extraction_issue,\n      fractionation_issue,\n      sampling_issue\n    )\n\n  DT::datatable(\n    display_df,\n    options = list(pageLength = 10),\n    caption = \"References with missing method information\"\n  )\n} else {\n  cat(\"*No missing methods found.*\")\n}\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-0782d7702a8c46e066e6\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-0782d7702a8c46e066e6\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"caption\":\"<caption>References with missing method information<\\/caption>\",\"data\":[[\"1\"],[\"\"],[49],[\"Missing\"],[\"Missing\"],[\"Missing\"],[\"Missing\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>REFERENCE_ID<\\/th>\\n      <th>n_rows<\\/th>\\n      <th>analytical_issue<\\/th>\\n      <th>extraction_issue<\\/th>\\n      <th>fractionation_issue<\\/th>\\n      <th>sampling_issue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":10,\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":2},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"REFERENCE_ID\",\"targets\":1},{\"name\":\"n_rows\",\"targets\":2},{\"name\":\"analytical_issue\",\"targets\":3},{\"name\":\"extraction_issue\",\"targets\":4},{\"name\":\"fractionation_issue\",\"targets\":5},{\"name\":\"sampling_issue\",\"targets\":6}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Missing Uncertainty\n\nRows where UNCERTAINTY_TYPE or UNCERTAINTY\\_\\*\\_STANDARD are missing.\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: missing-uncertainty\n#| echo: false\n\nif (nrow(literature_qc$missing_uncertainty) > 0) {\n  display_df <- literature_qc$missing_uncertainty |>\n    dplyr::mutate(\n      uncertainty_type_issue = dplyr::case_when(\n        type_missing ~ \"Missing\",\n        type_not_reported ~ \"Not reported\",\n        type_not_relevant ~ \"Not relevant\",\n        .default = NA_character_\n      ),\n      upper_bound_issue = dplyr::case_when(\n        upper_missing ~ \"Missing\",\n        upper_zero ~ \"Zero\",\n        upper_below_value ~ \"< Average\",\n        .default = NA_character_\n      ),\n      lower_bound_issue = dplyr::case_when(\n        lower_missing ~ \"Missing\",\n        lower_zero ~ \"Zero\",\n        lower_above_value ~ \"> Average\",\n        .default = NA_character_\n      )\n    ) |>\n    dplyr::select(\n      REFERENCE_ID,\n      n_rows,\n      uncertainty_type_issue,\n      upper_bound_issue,\n      lower_bound_issue\n    )\n\n  DT::datatable(\n    display_df,\n    options = list(pageLength = 10),\n    caption = \"References with missing or problematic uncertainty\"\n  )\n} else {\n  cat(\"*No uncertainty issues found.*\")\n}\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-c9a0cc900176f7dae8c8\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-c9a0cc900176f7dae8c8\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"caption\":\"<caption>References with missing or problematic uncertainty<\\/caption>\",\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\"],[\"\",\"2000JulshamnTraceElementLevels\",\"2002HellandTransportAndSedimentation\",\"2006ZaukeHeavyMetalsIn\",\"2011CaiContentAndDistribution\",\"2018ErvikToxicAndEssential\",\"2019SchaanningBenthicCommunityStatus\",\"2019SimonsenLabilityOfToxic\",\"2019SndergaardGreenSeaUrchins\",\"2021LehmannKonEffectsOfBiotransport\",\"2022KohlerDistributionPatternOf\",\"2022ParoliniTrendsAndPotential\",\"2022PedersenImpactsOfClimate\",\"2024HoffBiogeochemicalImpactOf\",\"2024IglikowskaTraceMetalsIn\",\"2025PelkonenEnvironmentalImpactOf\",\"UnknownReference\",\"VannmiljøCopper2010-2025\"],[49,18,48,11,25,8,6,140,9,1,25,41,11,42,20,3,1,48384],[\"Missing\",\"Not reported\",\"Not relevant\",\"Missing\",\"Not relevant\",\"Not relevant\",\"Not relevant\",\"Not reported\",\"Not reported\",null,\"Not relevant\",\"Not reported\",\"Not reported\",\"Not relevant\",\"Not relevant\",\"Not reported\",null,\"Not reported\"],[\"Missing\",\"Missing\",\"Missing\",null,\"Missing\",\"Missing\",\"Missing\",\"Missing\",\"Missing\",null,\"Missing\",\"Missing\",\"Missing\",\"Missing\",\"Missing\",\"Missing\",\"Missing\",\"Missing\"],[\"Missing\",\"Missing\",\"Missing\",null,\"Missing\",\"Missing\",\"Missing\",\"Missing\",\"Missing\",\"Zero\",\"Missing\",\"Missing\",\"Missing\",\"Missing\",\"Missing\",\"Missing\",\"Missing\",\"Missing\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>REFERENCE_ID<\\/th>\\n      <th>n_rows<\\/th>\\n      <th>uncertainty_type_issue<\\/th>\\n      <th>upper_bound_issue<\\/th>\\n      <th>lower_bound_issue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":10,\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":2},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"REFERENCE_ID\",\"targets\":1},{\"name\":\"n_rows\",\"targets\":2},{\"name\":\"uncertainty_type_issue\",\"targets\":3},{\"name\":\"upper_bound_issue\",\"targets\":4},{\"name\":\"lower_bound_issue\",\"targets\":5}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Missing Site Data\n\nSites missing coordinates, geographic features, country, or ocean information.\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: missing-sites\n#| echo: false\n\nif (nrow(literature_qc$missing_sites) > 0) {\n  DT::datatable(\n    literature_qc$missing_sites,\n    options = list(pageLength = 10),\n    caption = \"Sites with missing geographic data\"\n  )\n} else {\n  cat(\"*No missing site data found.*\")\n}\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-f81c9f9b9cd85aaa82b6\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-f81c9f9b9cd85aaa82b6\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"caption\":\"<caption>Sites with missing geographic data<\\/caption>\",\"data\":[[\"1\",\"2\",\"3\",\"4\"],[\"\",\"2017RasmussenEffectsOfIndustrial\",\"2017RasmussenEffectsOfIndustrial\",\"2017RasmussenEffectsOfIndustrial\"],[\"\",\"seafoodprocessing_Atlantic_salmon\",\"seafoodprocessing_Greenland_halibut\",\"seafoodprocessing_Greenland_prawns\"],[49,1,1,1],[true,true,true,true],[true,true,true,true],[true,true,true,true],[true,true,true,true],[true,true,true,true],[true,true,true,true]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>REFERENCE_ID<\\/th>\\n      <th>SITE_CODE<\\/th>\\n      <th>n_rows<\\/th>\\n      <th>missing_coords<\\/th>\\n      <th>missing_name<\\/th>\\n      <th>missing_feature<\\/th>\\n      <th>missing_feature_sub<\\/th>\\n      <th>missing_country<\\/th>\\n      <th>missing_ocean<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":10,\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":3},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"REFERENCE_ID\",\"targets\":1},{\"name\":\"SITE_CODE\",\"targets\":2},{\"name\":\"n_rows\",\"targets\":3},{\"name\":\"missing_coords\",\"targets\":4},{\"name\":\"missing_name\",\"targets\":5},{\"name\":\"missing_feature\",\"targets\":6},{\"name\":\"missing_feature_sub\",\"targets\":7},{\"name\":\"missing_country\",\"targets\":8},{\"name\":\"missing_ocean\",\"targets\":9}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Missing Biota Data\n\nBiota samples missing species, tissue, lifestage, gender, or species group.\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: missing-biota\n#| echo: false\n\nif (nrow(literature_qc$missing_biota) > 0) {\n  DT::datatable(\n    literature_qc$missing_biota |>\n      dplyr::select(-sample_ids),\n    options = list(pageLength = 10),\n    caption = \"References with missing biota information\"\n  )\n} else {\n  cat(\"*No missing biota data found.*\")\n}\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-4f96a090cdc00237fb39\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-4f96a090cdc00237fb39\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"caption\":\"<caption>References with missing biota information<\\/caption>\",\"data\":[[\"1\"],[\"2018ErvikToxicAndEssential\"],[1],[true],[true],[true],[true],[true]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>REFERENCE_ID<\\/th>\\n      <th>n_rows<\\/th>\\n      <th>missing_species<\\/th>\\n      <th>missing_tissue<\\/th>\\n      <th>missing_lifestage<\\/th>\\n      <th>missing_gender<\\/th>\\n      <th>missing_group<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":10,\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":2},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"REFERENCE_ID\",\"targets\":1},{\"name\":\"n_rows\",\"targets\":2},{\"name\":\"missing_species\",\"targets\":3},{\"name\":\"missing_tissue\",\"targets\":4},{\"name\":\"missing_lifestage\",\"targets\":5},{\"name\":\"missing_gender\",\"targets\":6},{\"name\":\"missing_group\",\"targets\":7}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/htmltools-fill-0.5.9/fill.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/datatables-binding-0.34.0/datatables.js\"></script>\n<script src=\"../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.2/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.2/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}